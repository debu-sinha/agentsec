{
  "version": "0.4.0",
  "scan_id": "8186c2653402",
  "timestamp": "2026-02-17T00:24:00.935436Z",
  "target_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1",
  "agent_type": "openclaw",
  "findings": [
    {
      "id": "03ed749a0666",
      "scanner": "installation",
      "category": "insecure_permissions",
      "severity": "high",
      "title": "World-readable sensitive file: exec-approvals.json",
      "description": "The file 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\exec-approvals.json' is readable by all users on the system. Any local process or user can read its contents, which may include API keys, tokens, and other credentials.",
      "evidence": "Permissions: 666",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\exec-approvals.json",
      "line_number": null,
      "remediation": {
        "summary": "Restrict permissions on exec-approvals.json to owner-only",
        "steps": [
          "chmod 600 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\exec-approvals.json'",
          "Verify no other processes depend on group/world access"
        ],
        "automated": true,
        "command": "chmod 600 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\exec-approvals.json'",
        "references": []
      },
      "owasp_ids": [
        "ASI05"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932008Z",
      "fingerprint": "2b50aeffb8e832cb"
    },
    {
      "id": "4a9811a913ac",
      "scanner": "installation",
      "category": "insecure_permissions",
      "severity": "high",
      "title": "World-readable sensitive file: openclaw.json",
      "description": "The file 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json' is readable by all users on the system. Any local process or user can read its contents, which may include API keys, tokens, and other credentials.",
      "evidence": "Permissions: 666",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Restrict permissions on openclaw.json to owner-only",
        "steps": [
          "chmod 600 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json'",
          "Verify no other processes depend on group/world access"
        ],
        "automated": true,
        "command": "chmod 600 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json'",
        "references": []
      },
      "owasp_ids": [
        "ASI05"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932054Z",
      "fingerprint": "b77e95f6ddaa5771"
    },
    {
      "id": "2f751b4b5a08",
      "scanner": "installation",
      "category": "insecure_permissions",
      "severity": "high",
      "title": "Agent config directory world-accessible: .openclaw",
      "description": "The directory 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw' is accessible by all users. This directory contains agent configuration, credentials, session history, and exec approvals.",
      "evidence": "Permissions: 777",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw",
      "line_number": null,
      "remediation": {
        "summary": "Restrict .openclaw to owner-only access",
        "steps": [
          "chmod 700 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw'"
        ],
        "automated": true,
        "command": "chmod 700 'C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw'",
        "references": []
      },
      "owasp_ids": [
        "ASI05"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932097Z",
      "fingerprint": "24b68bfac5dcb29c"
    },
    {
      "id": "b748e6ac4afe",
      "scanner": "installation",
      "category": "network_exposure",
      "severity": "critical",
      "title": "Gateway bound to non-loopback interface",
      "description": "The OpenClaw Gateway is configured with bind='0.0.0.0', exposing the control interface beyond localhost. Unless protected by a firewall and strong auth, this allows remote attackers to interact with the agent directly.",
      "evidence": "gateway.bind = 0.0.0.0",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Bind Gateway to loopback or add strong authentication",
        "steps": [
          "Set gateway.bind to 'loopback' (default)",
          "If remote access is needed, use a reverse proxy with auth",
          "Ensure firewall rules restrict access to trusted IPs"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": []
      },
      "owasp_ids": [
        "ASI05",
        "ASI02"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932827Z",
      "fingerprint": "a04f4e0d6db4fcbd"
    },
    {
      "id": "c12e4fbe071c",
      "scanner": "installation",
      "category": "missing_auth",
      "severity": "high",
      "title": "No WebSocket origin validation configured",
      "description": "The WebSocket server does not validate the Origin header. This enables Cross-Site WebSocket Hijacking from malicious webpages.",
      "evidence": null,
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Configure allowed origins",
        "steps": [
          "Set 'allowed_origins' to specific trusted domains"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": []
      },
      "owasp_ids": [
        "ASI05",
        "ASI01"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932839Z",
      "fingerprint": "c52f78402ae026e1"
    },
    {
      "id": "ae54922048e9",
      "scanner": "installation",
      "category": "missing_auth",
      "severity": "critical",
      "title": "Gateway auth missing on non-loopback interface",
      "description": "The Gateway is bound to '0.0.0.0' but has no authentication configured. Any device on the network can control the agent.",
      "evidence": "gateway.bind=0.0.0.0, gateway.auth=<missing>",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Configure token or password authentication",
        "steps": [
          "Set gateway.auth.token or gateway.auth.password",
          "Prefer token-based auth for programmatic access"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": [
          "https://docs.openclaw.ai/gateway/security"
        ]
      },
      "owasp_ids": [
        "ASI05",
        "ASI02"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932849Z",
      "fingerprint": "f7f35999f00de290"
    },
    {
      "id": "5c29c97326b0",
      "scanner": "installation",
      "category": "insecure_config",
      "severity": "critical",
      "title": "DM policy set to 'open' \u2014 anyone can message the agent",
      "description": "The agent accepts direct messages from anyone without pairing or allowlisting. This makes the agent a direct target for prompt injection attacks from untrusted users.",
      "evidence": "dmPolicy = open",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Restrict DM access to paired/allowlisted users",
        "steps": [
          "Set dmPolicy to 'paired' or 'allowlist'",
          "Use 'openclaw config set dmPolicy paired'"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": [
          "https://docs.openclaw.ai/gateway/security"
        ]
      },
      "owasp_ids": [
        "ASI01",
        "ASI02",
        "ASI10"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932862Z",
      "fingerprint": "d88a165db01dadaa"
    },
    {
      "id": "b723ff70dcee",
      "scanner": "installation",
      "category": "insecure_config",
      "severity": "critical",
      "title": "Group policy is 'open' \u2014 agent responds in any group",
      "description": "The agent will respond to messages in any group it's added to. In large or public groups, untrusted users can inject prompts and trigger tool execution.",
      "evidence": "groupPolicy = open",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Restrict group policy to allowlisted groups",
        "steps": [
          "Set groupPolicy to 'allowlist'",
          "Maintain an explicit list of trusted group IDs"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": []
      },
      "owasp_ids": [
        "ASI01",
        "ASI02"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932870Z",
      "fingerprint": "dce3499fcb2f98e0"
    },
    {
      "id": "55ef5a6ab115",
      "scanner": "installation",
      "category": "insecure_default",
      "severity": "critical",
      "title": "Full tool profile with open inbound access",
      "description": "tools.profile is 'unset (defaults to full)' and the agent accepts messages from untrusted sources. This gives prompt-injected inputs access to all tools including exec, browser, and filesystem.",
      "evidence": "tools.profile=unset, dmPolicy=open",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Restrict tool profile for untrusted input routes",
        "steps": [
          "Set tools.profile to 'messaging' or 'minimal'",
          "Explicitly allow only needed tools via tools.allow",
          "Use 'openclaw config set tools.profile messaging'"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": [
          "https://docs.openclaw.ai/tools"
        ]
      },
      "owasp_ids": [
        "ASI02",
        "ASI01",
        "ASI10"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.932882Z",
      "fingerprint": "cf4b07b140310761"
    },
    {
      "id": "9f6c6612c8b5",
      "scanner": "installation",
      "category": "insecure_default",
      "severity": "high",
      "title": "Sandboxing disabled with full tool access and open input",
      "description": "The agent has full tool access and accepts untrusted input, but sandboxing is not enabled. Without container isolation, compromised tool calls run directly on the host.",
      "evidence": "sandbox.mode=unset, tools.profile=full",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Enable sandboxing for untrusted-input agents",
        "steps": [
          "Set sandbox.mode to 'all' or 'non-main'",
          "Or restrict tools.profile to 'messaging'/'minimal'"
        ],
        "automated": true,
        "command": "agentsec harden ~ -p workstation --apply",
        "references": [
          "https://docs.openclaw.ai/tools/multi-agent-sandbox-tools"
        ]
      },
      "owasp_ids": [
        "ASI02",
        "ASI08"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.933002Z",
      "fingerprint": "bcea8d78d7bd3297"
    },
    {
      "id": "ee360176b20c",
      "scanner": "installation",
      "category": "missing_auth",
      "severity": "critical",
      "title": "Authentication disabled on non-loopback agent",
      "description": "The agent is accessible beyond localhost but has no authentication configured. Anyone who can reach the interface can issue commands and access credentials.",
      "evidence": null,
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Enable authentication",
        "steps": [
          "Enable auth in agent configuration",
          "Set a strong, unique access token"
        ],
        "automated": false,
        "command": null,
        "references": []
      },
      "owasp_ids": [
        "ASI05",
        "ASI02"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.933014Z",
      "fingerprint": "2b604b32df3654af"
    },
    {
      "id": "b8ab956541f8",
      "scanner": "installation",
      "category": "insecure_default",
      "severity": "high",
      "title": "No SSRF protection configured for URL-based inputs",
      "description": "The agent can process URL-based inputs (input_file, input_image) but has no SSRF deny policy or hostname allowlist configured. Attackers can use the agent to scan internal networks, access cloud metadata endpoints (169.254.169.254), or exfiltrate data to external servers.",
      "evidence": "security.ssrf.denyPolicy and hostnameAllowlist are both absent",
      "file_path": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json",
      "line_number": null,
      "remediation": {
        "summary": "Configure SSRF deny policy and hostname allowlist",
        "steps": [
          "Set security.ssrf.denyPolicy to block internal/private ranges",
          "Set security.ssrf.hostnameAllowlist to trusted domains",
          "Enable audit logging for blocked fetch attempts",
          "Update to OpenClaw v2026.2.12+ which includes built-in SSRF deny"
        ],
        "automated": false,
        "command": null,
        "references": [
          "https://nvd.nist.gov/vuln/detail/CVE-2026-25475"
        ]
      },
      "owasp_ids": [
        "ASI05",
        "ASI02"
      ],
      "cve_ids": [],
      "metadata": {},
      "timestamp": "2026-02-17T00:24:00.933384Z",
      "fingerprint": "e0ca0d7e99dcc928"
    }
  ],
  "owasp_mappings": [
    {
      "finding_id": "03ed749a0666",
      "categories": [
        "ASI05"
      ],
      "risk_score": 7.5,
      "rationale": "Finding 'World-readable sensitive file: exec-approvals.json' (high) maps to ASI05 (Privilege Compromise / Credential Theft). Category: insecure_permissions."
    },
    {
      "finding_id": "4a9811a913ac",
      "categories": [
        "ASI05"
      ],
      "risk_score": 7.5,
      "rationale": "Finding 'World-readable sensitive file: openclaw.json' (high) maps to ASI05 (Privilege Compromise / Credential Theft). Category: insecure_permissions."
    },
    {
      "finding_id": "2f751b4b5a08",
      "categories": [
        "ASI05"
      ],
      "risk_score": 7.5,
      "rationale": "Finding 'Agent config directory world-accessible: .openclaw' (high) maps to ASI05 (Privilege Compromise / Credential Theft). Category: insecure_permissions."
    },
    {
      "finding_id": "b748e6ac4afe",
      "categories": [
        "ASI05",
        "ASI02"
      ],
      "risk_score": 10.0,
      "rationale": "Finding 'Gateway bound to non-loopback interface' (critical) maps to ASI05 (Privilege Compromise / Credential Theft), ASI02 (Excessive Agency / Overprivileged Agents). Category: network_exposure."
    },
    {
      "finding_id": "c12e4fbe071c",
      "categories": [
        "ASI05",
        "ASI01"
      ],
      "risk_score": 8.2,
      "rationale": "Finding 'No WebSocket origin validation configured' (high) maps to ASI05 (Privilege Compromise / Credential Theft), ASI01 (Agent Goal Hijack / Prompt Injection). Category: missing_auth."
    },
    {
      "finding_id": "ae54922048e9",
      "categories": [
        "ASI05",
        "ASI02"
      ],
      "risk_score": 10.0,
      "rationale": "Finding 'Gateway auth missing on non-loopback interface' (critical) maps to ASI05 (Privilege Compromise / Credential Theft), ASI02 (Excessive Agency / Overprivileged Agents). Category: missing_auth."
    },
    {
      "finding_id": "5c29c97326b0",
      "categories": [
        "ASI01",
        "ASI02",
        "ASI10"
      ],
      "risk_score": 10.0,
      "rationale": "Finding 'DM policy set to 'open' \u2014 anyone can message the agent' (critical) maps to ASI01 (Agent Goal Hijack / Prompt Injection), ASI02 (Excessive Agency / Overprivileged Agents), ASI10 (Misaligned Behaviors / Unintended Actions). Category: insecure_config."
    },
    {
      "finding_id": "b723ff70dcee",
      "categories": [
        "ASI01",
        "ASI02"
      ],
      "risk_score": 8.2,
      "rationale": "Finding 'Group policy is 'open' \u2014 agent responds in any group' (high) maps to ASI01 (Agent Goal Hijack / Prompt Injection), ASI02 (Excessive Agency / Overprivileged Agents). Category: insecure_config."
    },
    {
      "finding_id": "55ef5a6ab115",
      "categories": [
        "ASI02",
        "ASI01",
        "ASI10"
      ],
      "risk_score": 10.0,
      "rationale": "Finding 'Full tool profile with open inbound access' (critical) maps to ASI02 (Excessive Agency / Overprivileged Agents), ASI01 (Agent Goal Hijack / Prompt Injection), ASI10 (Misaligned Behaviors / Unintended Actions). Category: insecure_default."
    },
    {
      "finding_id": "9f6c6612c8b5",
      "categories": [
        "ASI02",
        "ASI08"
      ],
      "risk_score": 8.2,
      "rationale": "Finding 'Sandboxing disabled with full tool access and open input' (high) maps to ASI02 (Excessive Agency / Overprivileged Agents), ASI08 (Uncontrolled Cascading / Runaway Agents). Category: insecure_default."
    },
    {
      "finding_id": "ee360176b20c",
      "categories": [
        "ASI05",
        "ASI02"
      ],
      "risk_score": 10.0,
      "rationale": "Finding 'Authentication disabled on non-loopback agent' (critical) maps to ASI05 (Privilege Compromise / Credential Theft), ASI02 (Excessive Agency / Overprivileged Agents). Category: missing_auth."
    },
    {
      "finding_id": "b8ab956541f8",
      "categories": [
        "ASI05",
        "ASI02"
      ],
      "risk_score": 8.2,
      "rationale": "Finding 'No SSRF protection configured for URL-based inputs' (high) maps to ASI05 (Privilege Compromise / Credential Theft), ASI02 (Excessive Agency / Overprivileged Agents). Category: insecure_default."
    }
  ],
  "summary": {
    "total_findings": 12,
    "critical": 5,
    "high": 7,
    "medium": 0,
    "low": 0,
    "info": 0,
    "scanners_run": [
      "installation",
      "skill",
      "mcp",
      "credential"
    ],
    "files_scanned": 4,
    "duration_seconds": 0.003568499996617902,
    "owasp_categories_hit": [
      "ASI01",
      "ASI02",
      "ASI05",
      "ASI08",
      "ASI10"
    ]
  },
  "metadata": {
    "config_files_found": {
      "exec-approvals.json": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\exec-approvals.json",
      "openclaw.json": "C:\\Users\\dsinh\\agentsec-dev\\agentsec\\.tmp\\repro-case1\\.openclaw\\openclaw.json"
    },
    "secrets_locations": []
  },
  "posture": {
    "overall_score": 5.0,
    "category_scores": {
      "ASI01: Agent Goal Hijack / Prompt Injection": 5.0,
      "ASI02: Excessive Agency / Overprivileged Agents": 0.0,
      "ASI03: Supply Chain Vulnerabilities": 10.0,
      "ASI04: Knowledge Poisoning / Data Integrity": 10.0,
      "ASI05: Privilege Compromise / Credential Theft": 1.0,
      "ASI06: Memory & Context Manipulation": 10.0,
      "ASI07: Multi-Agent System Exploitation": 10.0,
      "ASI08: Uncontrolled Cascading / Runaway Agents": 9.0,
      "ASI09: Repudiation / Insufficient Audit Trail": 10.0,
      "ASI10: Misaligned Behaviors / Unintended Actions": 7.3
    },
    "grade": "F"
  }
}